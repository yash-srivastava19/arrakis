Search.setIndex({"alltitles": {"API Reference": [[0, "module-core_arrakis.attention_head_comp"], [1, "module-core_arrakis.attention_tools"], [2, "module-core_arrakis.causal_tracing_intervention"], [3, "module-core_arrakis.kg_extractor"], [6, "module-core_arrakis.logit_lens"], [7, "module-core_arrakis.model_surgery"], [9, "module-core_arrakis.read_write_heads"], [10, "module-core_arrakis.residual_decomposer"], [11, "module-core_arrakis.residual_tools"], [12, "module-core_arrakis.sparsity_analyzer"], [13, "module-core_arrakis.superposition_disentangler"]], "Arrakis Walkthrough": [[8, "arrakis-walkthrough"]], "Arrakis\u2019s documentation!": [[14, "arrakis-s-documentation"]], "Attention Head Composition": [[0, "attention-head-composition"]], "Attention Tools": [[1, "attention-tools"]], "AttentionHeadComposition": [[14, "module-core_arrakis.attention_head_comp"]], "AttentionTools": [[14, "module-core_arrakis.attention_tools"]], "Causal Tracing Intervention": [[2, "causal-tracing-intervention"]], "CausalTracingIntervention": [[14, "module-core_arrakis.causal_tracing_intervention"]], "Contents:": [[14, null]], "Example Usage": [[0, "example-usage"], [1, "example-usage"], [2, "example-usage"], [3, "example-usage"], [4, "example-usage"], [5, "example-usage"], [6, "example-usage"], [7, "example-usage"], [9, "example-usage"], [10, "example-usage"], [11, "example-usage"], [12, "example-usage"], [13, "example-usage"]], "Extending Arrakis": [[8, "extending-arrakis"]], "Introduction": [[0, "introduction"], [1, "introduction"], [2, "introduction"], [3, "introduction"], [4, "introduction"], [5, "introduction"], [6, "introduction"], [7, "introduction"], [8, "introduction"], [9, "introduction"], [10, "introduction"], [11, "introduction"], [12, "introduction"], [13, "introduction"]], "Knowledge Graph Extractor": [[3, "knowledge-graph-extractor"]], "Knowledge Prober": [[4, "knowledge-prober"]], "KnowledgeGraphExtractor": [[14, "module-core_arrakis.kg_extractor"]], "KnowledgeProber": [[14, "module-core_arrakis.knowledge_prober"]], "List of Tools": [[8, "list-of-tools"]], "Logit Attribution": [[5, "logit-attribution"]], "LogitAttribution": [[14, "module-core_arrakis.logit_attribution"]], "LogitLens": [[6, "logitlens"], [14, "module-core_arrakis.logit_lens"]], "Methods": [[4, "module-core_arrakis.knowledge_prober"], [5, "module-core_arrakis.logit_attribution"]], "Model Surgery": [[7, "model-surgery"]], "ModelSurgery": [[14, "module-core_arrakis.model_surgery"]], "Read Write Heads": [[9, "read-write-heads"]], "ReadWriteHeads": [[14, "module-core_arrakis.read_write_heads"]], "Residual Decomposer": [[10, "residual-decomposer"]], "Residual Tools": [[11, "residual-tools"]], "ResidualDecomposer": [[14, "module-core_arrakis.residual_decomposer"]], "ResidualTools": [[14, "module-core_arrakis.residual_tools"]], "Resources": [[0, "resources"], [1, "resources"], [2, "resources"], [3, "resources"], [4, "resources"], [5, "resources"], [6, "resources"], [7, "resources"], [9, "resources"], [10, "resources"], [11, "resources"], [12, "resources"], [13, "resources"]], "Sparsity Analyzer": [[12, "sparsity-analyzer"]], "SparsityAnalyzer": [[14, "module-core_arrakis.sparsity_analyzer"]], "Step 1: Install the package": [[8, "step-1-install-the-package"]], "Step 2: Create HookedAutoModel": [[8, "step-2-create-hookedautomodel"]], "Step 3: Set up Interpretability Bench": [[8, "step-3-set-up-interpretability-bench"]], "Step 4: Create you experiments": [[8, "step-4-create-you-experiments"]], "Step 5: Visualize the Results": [[8, "step-5-visualize-the-results"]], "Superposition Disentangler": [[13, "superposition-disentangler"]], "SuperpositionDisentangler": [[14, "module-core_arrakis.superposition_disentangler"]], "Tools and Decomposibility": [[8, "tools-and-decomposibility"]]}, "docnames": ["AttentionHeadComposition", "AttentionTools", "CausalTracingIntervention", "KnowledgeGraphExtractor", "KnowledgeProber", "LogitAttribution", "LogitLens", "ModelSurgery", "README", "ReadWriteHeads", "ResidualDecomposer", "ResidualTools", "SparsityAnalyzer", "SuperpositionDisentangler", "index"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["AttentionHeadComposition.md", "AttentionTools.md", "CausalTracingIntervention.md", "KnowledgeGraphExtractor.md", "KnowledgeProber.md", "LogitAttribution.md", "LogitLens.md", "ModelSurgery.md", "README.md", "ReadWriteHeads.md", "ResidualDecomposer.md", "ResidualTools.md", "SparsityAnalyzer.md", "SuperpositionDisentangler.md", "index.rst"], "indexentries": {"ablate_head() (core_arrakis.attention_tools.attentiontools method)": [[14, "core_arrakis.attention_tools.AttentionTools.ablate_head", false]], "apply_composed_head() (core_arrakis.attention_head_comp.attentioncomposer method)": [[14, "core_arrakis.attention_head_comp.AttentionComposer.apply_composed_head", false]], "attention_path_patching() (core_arrakis.attention_head_comp.attentioncomposer method)": [[14, "core_arrakis.attention_head_comp.AttentionComposer.attention_path_patching", false]], "attention_patterns() (core_arrakis.attention_tools.attentiontools method)": [[14, "core_arrakis.attention_tools.AttentionTools.attention_patterns", false]], "attentioncomposer (class in core_arrakis.attention_head_comp)": [[14, "core_arrakis.attention_head_comp.AttentionComposer", false]], "attentiontools (class in core_arrakis.attention_tools)": [[14, "core_arrakis.attention_tools.AttentionTools", false]], "causaltracer (class in core_arrakis.causal_tracing_intervention)": [[14, "core_arrakis.causal_tracing_intervention.CausalTracer", false]], "compute_activation_covariance() (core_arrakis.superposition_disentangler.superpositiondisentangler method)": [[14, "core_arrakis.superposition_disentangler.SuperpositionDisentangler.compute_activation_covariance", false]], "compute_activation_sparsity() (core_arrakis.sparsity_analyzer.sparsityanalyzer method)": [[14, "core_arrakis.sparsity_analyzer.SparsityAnalyzer.compute_activation_sparsity", false]], "core_arrakis.attention_head_comp": [[14, "module-core_arrakis.attention_head_comp", false]], "core_arrakis.attention_tools": [[14, "module-core_arrakis.attention_tools", false]], "core_arrakis.causal_tracing_intervention": [[14, "module-core_arrakis.causal_tracing_intervention", false]], "core_arrakis.kg_extractor": [[14, "module-core_arrakis.kg_extractor", false]], "core_arrakis.knowledge_prober": [[14, "module-core_arrakis.knowledge_prober", false]], "core_arrakis.logit_attribution": [[14, "module-core_arrakis.logit_attribution", false]], "core_arrakis.logit_lens": [[14, "module-core_arrakis.logit_lens", false]], "core_arrakis.model_surgery": [[14, "module-core_arrakis.model_surgery", false]], "core_arrakis.read_write_heads": [[14, "module-core_arrakis.read_write_heads", false]], "core_arrakis.residual_decomposer": [[14, "module-core_arrakis.residual_decomposer", false]], "core_arrakis.residual_tools": [[14, "module-core_arrakis.residual_tools", false]], "core_arrakis.sparsity_analyzer": [[14, "module-core_arrakis.sparsity_analyzer", false]], "core_arrakis.superposition_disentangler": [[14, "module-core_arrakis.superposition_disentangler", false]], "decompose_residual() (core_arrakis.residual_decomposer.residualdecomposer method)": [[14, "core_arrakis.residual_decomposer.ResidualDecomposer.decompose_residual", false]], "delete_layers() (core_arrakis.model_surgery.modelsurgery method)": [[14, "core_arrakis.model_surgery.ModelSurgery.delete_layers", false]], "disentangle_superposition() (core_arrakis.superposition_disentangler.superpositiondisentangler method)": [[14, "core_arrakis.superposition_disentangler.SuperpositionDisentangler.disentangle_superposition", false]], "extract_relational_subspaces() (core_arrakis.kg_extractor.knowledgegraphextractor method)": [[14, "core_arrakis.kg_extractor.KnowledgeGraphExtractor.extract_relational_subspaces", false]], "feature_attribution() (core_arrakis.residual_tools.residualtools method)": [[14, "core_arrakis.residual_tools.ResidualTools.feature_attribution", false]], "find_polysemantic_neurons() (core_arrakis.sparsity_analyzer.sparsityanalyzer method)": [[14, "core_arrakis.sparsity_analyzer.SparsityAnalyzer.find_polysemantic_neurons", false]], "get_model() (core_arrakis.model_surgery.modelsurgery method)": [[14, "core_arrakis.model_surgery.ModelSurgery.get_model", false]], "head_composition() (core_arrakis.attention_head_comp.attentioncomposer method)": [[14, "core_arrakis.attention_head_comp.AttentionComposer.head_composition", false]], "identify_read_heads() (core_arrakis.read_write_heads.writereadanalyzer method)": [[14, "core_arrakis.read_write_heads.WriteReadAnalyzer.identify_read_heads", false]], "identify_relation_types() (core_arrakis.kg_extractor.knowledgegraphextractor method)": [[14, "core_arrakis.kg_extractor.KnowledgeGraphExtractor.identify_relation_types", false]], "identify_write_heads() (core_arrakis.read_write_heads.writereadanalyzer method)": [[14, "core_arrakis.read_write_heads.WriteReadAnalyzer.identify_write_heads", false]], "interpolate_concepts() (core_arrakis.superposition_disentangler.superpositiondisentangler method)": [[14, "core_arrakis.superposition_disentangler.SuperpositionDisentangler.interpolate_concepts", false]], "intervene_on_neuron() (core_arrakis.causal_tracing_intervention.causaltracer method)": [[14, "core_arrakis.causal_tracing_intervention.CausalTracer.intervene_on_neuron", false]], "knowledge_probe() (core_arrakis.knowledge_prober.knowledgeprober method)": [[14, "core_arrakis.knowledge_prober.KnowledgeProber.knowledge_probe", false]], "knowledgegraphextractor (class in core_arrakis.kg_extractor)": [[14, "core_arrakis.kg_extractor.KnowledgeGraphExtractor", false]], "knowledgeprober (class in core_arrakis.knowledge_prober)": [[14, "core_arrakis.knowledge_prober.KnowledgeProber", false]], "layer_attributions() (core_arrakis.logit_lens.logitlens method)": [[14, "core_arrakis.logit_lens.LogitLens.layer_attributions", false]], "logit_attribution() (core_arrakis.logit_attribution.logitattributor method)": [[14, "core_arrakis.logit_attribution.LogitAttributor.logit_attribution", false]], "logit_lens() (core_arrakis.logit_lens.logitlens method)": [[14, "core_arrakis.logit_lens.LogitLens.logit_lens", false]], "logitattributor (class in core_arrakis.logit_attribution)": [[14, "core_arrakis.logit_attribution.LogitAttributor", false]], "logitlens (class in core_arrakis.logit_lens)": [[14, "core_arrakis.logit_lens.LogitLens", false]], "merge_heads() (core_arrakis.attention_tools.attentiontools method)": [[14, "core_arrakis.attention_tools.AttentionTools.merge_heads", false]], "mlp_basis() (core_arrakis.residual_decomposer.residualdecomposer method)": [[14, "core_arrakis.residual_decomposer.ResidualDecomposer.mlp_basis", false]], "modelsurgery (class in core_arrakis.model_surgery)": [[14, "core_arrakis.model_surgery.ModelSurgery", false]], "module": [[14, "module-core_arrakis.attention_head_comp", false], [14, "module-core_arrakis.attention_tools", false], [14, "module-core_arrakis.causal_tracing_intervention", false], [14, "module-core_arrakis.kg_extractor", false], [14, "module-core_arrakis.knowledge_prober", false], [14, "module-core_arrakis.logit_attribution", false], [14, "module-core_arrakis.logit_lens", false], [14, "module-core_arrakis.model_surgery", false], [14, "module-core_arrakis.read_write_heads", false], [14, "module-core_arrakis.residual_decomposer", false], [14, "module-core_arrakis.residual_tools", false], [14, "module-core_arrakis.sparsity_analyzer", false], [14, "module-core_arrakis.superposition_disentangler", false]], "permute_layers() (core_arrakis.model_surgery.modelsurgery method)": [[14, "core_arrakis.model_surgery.ModelSurgery.permute_layers", false]], "polysemantic_score() (core_arrakis.knowledge_prober.knowledgeprober method)": [[14, "core_arrakis.knowledge_prober.KnowledgeProber.polysemantic_score", false]], "project_activations() (core_arrakis.superposition_disentangler.superpositiondisentangler method)": [[14, "core_arrakis.superposition_disentangler.SuperpositionDisentangler.project_activations", false]], "project_token_embeddings() (core_arrakis.kg_extractor.knowledgegraphextractor method)": [[14, "core_arrakis.kg_extractor.KnowledgeGraphExtractor.project_token_embeddings", false]], "prune_network() (core_arrakis.sparsity_analyzer.sparsityanalyzer method)": [[14, "core_arrakis.sparsity_analyzer.SparsityAnalyzer.prune_network", false]], "reconstruct_activations() (core_arrakis.superposition_disentangler.superpositiondisentangler method)": [[14, "core_arrakis.superposition_disentangler.SuperpositionDisentangler.reconstruct_activations", false]], "replace_layers() (core_arrakis.model_surgery.modelsurgery method)": [[14, "core_arrakis.model_surgery.ModelSurgery.replace_layers", false]], "residual_decomposition() (core_arrakis.residual_tools.residualtools method)": [[14, "core_arrakis.residual_tools.ResidualTools.residual_decomposition", false]], "residual_movement() (core_arrakis.residual_tools.residualtools method)": [[14, "core_arrakis.residual_tools.ResidualTools.residual_movement", false]], "residualdecomposer (class in core_arrakis.residual_decomposer)": [[14, "core_arrakis.residual_decomposer.ResidualDecomposer", false]], "residualtools (class in core_arrakis.residual_tools)": [[14, "core_arrakis.residual_tools.ResidualTools", false]], "sparsityanalyzer (class in core_arrakis.sparsity_analyzer)": [[14, "core_arrakis.sparsity_analyzer.SparsityAnalyzer", false]], "superpositiondisentangler (class in core_arrakis.superposition_disentangler)": [[14, "core_arrakis.superposition_disentangler.SuperpositionDisentangler", false]], "top_attended_ids() (core_arrakis.attention_tools.attentiontools method)": [[14, "core_arrakis.attention_tools.AttentionTools.top_attended_ids", false]], "trace_information_flow() (core_arrakis.read_write_heads.writereadanalyzer method)": [[14, "core_arrakis.read_write_heads.WriteReadAnalyzer.trace_information_flow", false]], "trace_token_probability() (core_arrakis.causal_tracing_intervention.causaltracer method)": [[14, "core_arrakis.causal_tracing_intervention.CausalTracer.trace_token_probability", false]], "track_token_circulation() (core_arrakis.logit_attribution.logitattributor method)": [[14, "core_arrakis.logit_attribution.LogitAttributor.track_token_circulation", false]], "writereadanalyzer (class in core_arrakis.read_write_heads)": [[14, "core_arrakis.read_write_heads.WriteReadAnalyzer", false]]}, "objects": {"core_arrakis": [[14, 0, 0, "-", "attention_head_comp"], [14, 0, 0, "-", "attention_tools"], [14, 0, 0, "-", "causal_tracing_intervention"], [14, 0, 0, "-", "kg_extractor"], [14, 0, 0, "-", "knowledge_prober"], [14, 0, 0, "-", "logit_attribution"], [14, 0, 0, "-", "logit_lens"], [14, 0, 0, "-", "model_surgery"], [14, 0, 0, "-", "read_write_heads"], [14, 0, 0, "-", "residual_decomposer"], [14, 0, 0, "-", "residual_tools"], [14, 0, 0, "-", "sparsity_analyzer"], [14, 0, 0, "-", "superposition_disentangler"]], "core_arrakis.attention_head_comp": [[14, 1, 1, "", "AttentionComposer"]], "core_arrakis.attention_head_comp.AttentionComposer": [[14, 2, 1, "", "apply_composed_head"], [14, 2, 1, "", "attention_path_patching"], [14, 2, 1, "", "head_composition"]], "core_arrakis.attention_tools": [[14, 1, 1, "", "AttentionTools"]], "core_arrakis.attention_tools.AttentionTools": [[14, 2, 1, "", "ablate_head"], [14, 2, 1, "", "attention_patterns"], [14, 2, 1, "", "merge_heads"], [14, 2, 1, "", "top_attended_ids"]], "core_arrakis.causal_tracing_intervention": [[14, 1, 1, "", "CausalTracer"]], "core_arrakis.causal_tracing_intervention.CausalTracer": [[14, 2, 1, "", "intervene_on_neuron"], [14, 2, 1, "", "trace_token_probability"]], "core_arrakis.kg_extractor": [[14, 1, 1, "", "KnowledgeGraphExtractor"]], "core_arrakis.kg_extractor.KnowledgeGraphExtractor": [[14, 2, 1, "", "extract_relational_subspaces"], [14, 2, 1, "", "identify_relation_types"], [14, 2, 1, "", "project_token_embeddings"]], "core_arrakis.knowledge_prober": [[14, 1, 1, "", "KnowledgeProber"]], "core_arrakis.knowledge_prober.KnowledgeProber": [[14, 2, 1, "", "knowledge_probe"], [14, 2, 1, "", "polysemantic_score"]], "core_arrakis.logit_attribution": [[14, 1, 1, "", "LogitAttributor"]], "core_arrakis.logit_attribution.LogitAttributor": [[14, 2, 1, "", "logit_attribution"], [14, 2, 1, "", "track_token_circulation"]], "core_arrakis.logit_lens": [[14, 1, 1, "", "LogitLens"]], "core_arrakis.logit_lens.LogitLens": [[14, 2, 1, "", "layer_attributions"], [14, 2, 1, "", "logit_lens"]], "core_arrakis.model_surgery": [[14, 1, 1, "", "ModelSurgery"]], "core_arrakis.model_surgery.ModelSurgery": [[14, 2, 1, "", "delete_layers"], [14, 2, 1, "", "get_model"], [14, 2, 1, "", "permute_layers"], [14, 2, 1, "", "replace_layers"]], "core_arrakis.read_write_heads": [[14, 1, 1, "", "WriteReadAnalyzer"]], "core_arrakis.read_write_heads.WriteReadAnalyzer": [[14, 2, 1, "", "identify_read_heads"], [14, 2, 1, "", "identify_write_heads"], [14, 2, 1, "", "trace_information_flow"]], "core_arrakis.residual_decomposer": [[14, 1, 1, "", "ResidualDecomposer"]], "core_arrakis.residual_decomposer.ResidualDecomposer": [[14, 2, 1, "", "decompose_residual"], [14, 2, 1, "", "mlp_basis"]], "core_arrakis.residual_tools": [[14, 1, 1, "", "ResidualTools"]], "core_arrakis.residual_tools.ResidualTools": [[14, 2, 1, "", "feature_attribution"], [14, 2, 1, "", "residual_decomposition"], [14, 2, 1, "", "residual_movement"]], "core_arrakis.sparsity_analyzer": [[14, 1, 1, "", "SparsityAnalyzer"]], "core_arrakis.sparsity_analyzer.SparsityAnalyzer": [[14, 2, 1, "", "compute_activation_sparsity"], [14, 2, 1, "", "find_polysemantic_neurons"], [14, 2, 1, "", "prune_network"]], "core_arrakis.superposition_disentangler": [[14, 1, 1, "", "SuperpositionDisentangler"]], "core_arrakis.superposition_disentangler.SuperpositionDisentangler": [[14, 2, 1, "", "compute_activation_covariance"], [14, 2, 1, "", "disentangle_superposition"], [14, 2, 1, "", "interpolate_concepts"], [14, 2, 1, "", "project_activations"], [14, 2, 1, "", "reconstruct_activations"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method"}, "terms": {"": [1, 2, 4, 5, 6, 8, 9, 10, 11, 13], "0": [0, 1, 2, 3, 7, 8, 9, 12, 14], "1": [7, 10, 12, 14], "10": [10, 13, 14], "128": 7, "2": [1, 5, 9, 14], "2021": [], "3": [3, 12, 14], "5": [0, 1, 4, 5, 14], "50": 4, "50256": 8, "7": 3, "8": [8, 9, 14], "9": [12, 14], "A": [0, 1, 2, 3, 4, 5, 9, 10, 11], "And": 8, "As": 8, "At": 8, "But": [], "By": [2, 3, 8], "If": [], "In": 8, "It": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "Its": [], "Not": [], "One": 8, "The": [0, 2, 3, 6, 8, 11, 14], "Then": 8, "There": 8, "These": [0, 3, 8], "To": 8, "With": [], "__init__": 8, "abil": [1, 9], "ablat": [1, 14], "ablate_head": [1, 14], "about": [5, 8], "abov": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "access": 8, "accord": 7, "achiev": [], "across": [4, 5, 9, 10, 11, 12], "act": 9, "action": 8, "activ": [2, 4, 8, 11, 12, 13, 14], "activation_cach": 8, "activationcach": 8, "ad": 8, "adapt": 8, "add": 8, "addit": 8, "adjust": 2, "affect": [2, 5], "after": 8, "agnost": 8, "ahead": [], "aim": 1, "algorithm": 0, "align": 8, "all": 8, "allow": [0, 1, 2, 3, 7, 10, 13], "alpha": [0, 1, 13, 14], "alreadi": 8, "also": 8, "alter": 1, "altern": [], "among": 3, "an": [3, 4, 5, 8, 9, 10, 11, 12], "analysi": [1, 2, 3, 4, 5, 6, 7, 8, 13], "analyz": [1, 3, 4, 6, 8, 9, 10, 11, 13, 14], "ani": [], "anoth": 8, "another_custom_funct": 8, "anthrop": 8, "anyon": 3, "apart": 8, "api": 8, "appli": [0, 5, 14], "applic": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "apply_composed_head": [0, 14], "approach": [0, 2, 8], "ar": [0, 1, 3, 8], "arbitrari": [], "architectur": [], "arg": 8, "argument": 8, "around": 8, "arrki": 8, "art": [], "ascii": [], "aspect": [0, 5], "assess": 1, "atleast": [], "attend": [1, 14], "attent": [2, 8, 10, 14], "attention_experi": 8, "attention_head_comp": [0, 14], "attention_heatmap": 8, "attention_path_patch": [0, 14], "attention_pattern": [1, 14], "attention_tool": [1, 14], "attentioncompos": [0, 14], "attentionheadcomposit": [], "attentiontool": 1, "attn": 8, "attribut": [6, 8, 11, 14], "attributor": 5, "auroencod": 12, "automodel": [], "back": [11, 14], "backend": [], "base": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "base_bench": 8, "base_graph": 8, "base_interpret": 8, "baseinteroretabilitybench": 8, "baseinterpretabilitybench": 8, "baseinterpretabilitytool": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "basi": [10, 14], "been": 8, "behind": [2, 3, 4, 8], "being": 8, "best": 8, "between": [1, 3, 4, 9, 11, 13, 14], "beyond": 0, "bias": 8, "big": [], "bigger": [], "bitch": [], "black": 8, "blip": 2, "bloom": [], "both": 8, "box": 8, "break": [11, 14], "c_attn": 8, "ca": 0, "calcualt": 8, "calcul": [2, 4, 5, 6], "call": [], "can": [0, 1, 2, 3, 8], "capabl": 6, "captur": 0, "care": [], "carri": [11, 14], "case": 8, "categori": 3, "causal": [8, 14], "causal_tracing_intervent": [2, 14], "causaltrac": [2, 14], "central": 1, "challeng": [], "chang": [2, 11, 14], "circuit": [0, 1, 3, 4, 5, 9, 10, 11], "circuitsvi": [], "circuitvi": [], "circul": [5, 14], "class": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "classif": 3, "clear": 8, "cli": [], "client": [], "code": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "cognit": [2, 14], "com": [], "combin": [1, 13], "come": [8, 11, 14], "common": 8, "commun": 8, "compat": [], "complement": 1, "complet": 8, "complex": [0, 12], "compon": [0, 10, 13, 14], "compos": [0, 14], "composit": [8, 14], "comprehens": [1, 3, 4, 5, 9, 10, 11], "comput": [2, 4, 5, 6, 8, 10, 12, 13, 14], "compute_activation_covari": [13, 14], "compute_activation_spars": [12, 14], "concept": [0, 4, 13, 14], "concept1": [13, 14], "concept2": [13, 14], "concept_neuron": [4, 14], "conceptu": 13, "conduct": 8, "config": 8, "configur": 8, "connect": [10, 11, 12], "constantli": 8, "constitu": 10, "construct": 3, "content": 8, "context": [0, 3, 4, 7, 9, 12, 14], "continu": 13, "contribut": [1, 5, 6, 8, 9, 10, 11, 13], "contributor": 10, "control": 8, "convini": 8, "core": [2, 8], "core_arraki": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "correspond": 0, "cov_matrix": [13, 14], "covari": [13, 14], "cross": [], "crucial": [0, 5, 6, 10, 11, 12, 13], "custom": 8, "custom_funct": 8, "customfunct": 8, "customtool": 8, "czz6fch4jspwcpu6c": [], "data": [0, 3], "data_kei": 8, "dataset": 4, "deafult": [], "deal": 8, "decis": [1, 5, 6, 11], "decompos": [11, 14], "decompose_residu": [10, 14], "decomposit": [8, 10], "decomps": 8, "decor": 8, "dedeuc": 0, "deep": 3, "deepen": [3, 4, 9, 10, 11], "deeper": [5, 9, 10], "deepli": 8, "def": 8, "default": 8, "defin": 3, "delet": [7, 14], "delete_lay": [7, 14], "delv": 5, "demonstr": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "depend": 0, "depth": 6, "deriv": [3, 8], "design": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13], "dest_head": [0, 14], "destin": [0, 9, 14], "detail": [6, 10], "determin": 3, "develop": 8, "differ": [0, 1, 3, 4, 5, 6, 8, 12, 13], "differenti": 4, "dim_idx": [8, 9, 14], "direct": [5, 14], "directli": 8, "disabl": 1, "disentangl": [8, 14], "disentangle_superposit": [13, 14], "dissect": [2, 5, 6], "distinct": [0, 3, 13], "distinguish": 9, "distribut": [2, 12], "dive": [], "divers": [4, 12], "do": 8, "doc": 8, "document": [], "doe": [], "doesn": 8, "done": 8, "down": [11, 14], "draw": 8, "dst_token": [9, 14], "dynam": [0, 9, 10, 11], "each": [0, 1, 5, 6, 9, 13, 14], "easi": 8, "easier": 8, "easili": 8, "edit": [2, 14], "effect": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "element": 10, "eleuth": [], "elicit": 7, "embed": [3, 4, 14], "empti": [], "enabl": [0, 4], "encod": 4, "encompass": 1, "engin": 8, "enhanc": 7, "especi": 8, "essenti": [3, 4, 5, 6, 9, 10, 11, 12, 13], "evalu": 4, "even": 8, "everydai": 8, "everyth": 8, "examin": [0, 4, 10, 13], "exampl": 8, "excit": 8, "exhibit": 12, "exp": 8, "experienc": 8, "experiment": [7, 8], "experimentbench": 8, "explan": 12, "explor": [3, 4, 5, 9, 10, 11, 13], "express": [], "extend": [0, 6], "extra": 8, "extract": [1, 3, 4, 9, 13, 14], "extract_relational_subspac": [3, 14], "extractor": [8, 14], "face": [], "facilit": [1, 3, 4, 7, 9], "factor": [2, 14], "fairli": 8, "fashion": 8, "feaatur": [], "featur": [2, 6, 8, 11], "feature_attribut": [11, 14], "feedback": 8, "field": 8, "fig": 8, "final": [2, 5, 7, 8, 11, 14], "find": [12, 14], "find_polysemantic_neuron": [12, 14], "first": 8, "flexibl": 8, "flow": [9, 10, 14], "focu": 0, "focus": [0, 2, 6, 9, 10, 13], "follow": 8, "form": 13, "formal": 0, "forward": 8, "foundat": [3, 4, 5, 9, 10, 11], "framework": [0, 1, 3, 4, 5, 9, 10, 11], "from": [0, 3, 7, 8, 9, 10, 11, 13, 14], "function": [1, 8], "fundament": 0, "futur": 8, "garcon": 8, "gemma": 8, "gener": [0, 8], "get": 8, "get_final_norm": 7, "get_model": [7, 14], "get_transformer_lay": 7, "get_vers": 8, "give": 8, "given": [2, 3, 4, 7, 8, 12, 13, 14], "glossari": [], "go": 8, "goal": 8, "gpt": [6, 8], "gpt2": 8, "granular": 2, "graph": [8, 14], "guess": [], "guid": 8, "h": 8, "ha": 8, "happen": 8, "hard": [], "hash": 8, "hassl": [], "have": [5, 8], "head": [1, 8, 14], "head1": [0, 14], "head2": [0, 14], "head_composit": [0, 14], "head_idx": [1, 14], "head_idx1": [1, 14], "head_idx2": [1, 14], "help": [1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14], "here": 8, "hf": [], "hidden_s": 8, "highest": 1, "highlight": 9, "hook": 8, "hookedautoconfig": 8, "hookedautomodel": [], "hookedconfig": 8, "hop": 8, "how": [1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14], "html": [], "http": [], "hug": [], "huggingfac": 8, "hypothes": 2, "hypothesi": 8, "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "id": [1, 2, 4, 12, 13, 14], "id_list": [12, 14], "idea": [2, 8], "identif": 3, "identifi": [1, 3, 4, 7, 9, 10, 12, 13, 14], "identify_read_head": [8, 9, 14], "identify_relation_typ": [3, 14], "identify_write_head": [8, 9, 14], "ids_list": [13, 14], "illustr": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "immedi": 0, "impact": [1, 2, 5], "implement": 8, "impoact": 2, "import": [7, 8], "includ": [], "incorpor": 8, "indentifi": [3, 14], "index": [5, 6], "indic": [7, 9, 14], "individu": [0, 1, 2, 13], "induct": 0, "infer": 0, "influenc": [2, 5, 6, 11], "info": [11, 14], "inform": [1, 3, 5, 9, 10, 11, 12, 14], "inherit": 8, "inner": [0, 7], "input": [0, 1, 2, 4, 5, 6, 11, 14], "input_id": [0, 1, 2, 5, 6, 8, 9, 10, 11, 14], "insid": 8, "insight": [2, 3, 5, 10], "instanc": 8, "instanti": 8, "instrument": 1, "interact": [3, 14], "interest": [4, 9, 10, 11], "intermedi": 8, "intermediate_s": 8, "intern": [4, 6], "interpol": [13, 14], "interpolate_concept": [13, 14], "interpret": [0, 2, 5, 6, 10, 11, 14], "interpretabilitybench": 8, "interpretbail": 8, "interven": [2, 14], "intervene_on_neuron": [2, 14], "intervent": [8, 14], "intric": 0, "introduc": [], "introduct": 14, "intuit": 12, "invalu": [3, 4, 5, 9, 10, 11], "invok": [], "involv": 8, "isol": 13, "json": 8, "just": 8, "k": [0, 1, 3, 4, 10, 14], "k_neighbor": [4, 14], "keep": 8, "kei": [0, 1, 3, 8], "kg_extractor": [3, 14], "knowledg": [6, 8, 14], "knowledge_prob": [4, 14], "knowledgegraphextractor": 3, "knowledgeprob": 4, "kwarg": 8, "l": 8, "langaug": 2, "languag": [], "larg": 8, "latent": 7, "launch": [], "layer": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14], "layer_attribut": [6, 14], "layer_idx": [1, 2, 3, 4, 6, 9, 10, 11, 14], "layer_idx1": [11, 14], "layer_idx2": [11, 14], "learn": 0, "len": [6, 7, 8, 14], "lesswrong": [], "let": 8, "level": 8, "leverag": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "lib": 8, "librari": 8, "light": 0, "like": 8, "linear": 7, "list": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "list_vers": 8, "littl": [], "ll": 8, "llama": 8, "lm": 8, "load": 8, "local": 8, "locat": [2, 14], "log": 8, "log_experi": 8, "logit": [6, 8, 14], "logit_attribut": [5, 14], "logit_len": [6, 14], "logitattributor": [5, 14], "logitlen": [], "look": [3, 4, 5, 7, 8, 9, 10, 11], "lot": 8, "m": 7, "made": 8, "make": [0, 1, 3, 4, 5, 6, 8, 9, 10, 11], "mani": 8, "manipul": [1, 14], "manner": [0, 8], "mathemat": [0, 1, 3, 4, 5, 9, 10, 11], "matplotlibwrapp": 8, "matrix": [3, 13, 14], "mayb": 8, "md": [], "mean": [4, 8], "measur": [11, 14], "mechan": [0, 1, 2, 3, 6], "mechanist": [2, 8], "mention": 8, "merg": [1, 14], "merge_head": [1, 14], "messi": 8, "method": [1, 2, 3, 6, 9, 10, 11, 12, 13], "methodologi": 2, "mi": [8, 12], "miexperi": 8, "might": 8, "mind": 8, "mistral": 8, "mix": [], "mlp": [10, 14], "mlp_basi": [10, 14], "model": [0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14], "model_surgeri": [7, 14], "modelsurgeri": 7, "modif": 7, "modifi": 7, "modul": 7, "monosemant": 8, "more": 8, "most": [5, 10], "move": [5, 8, 14], "movement": 11, "much": [8, 11, 14], "multi": [8, 10], "multifunction": 12, "multipl": [], "my": 8, "n": 13, "n_concept": [13, 14], "n_layer": [5, 9, 14], "name": 8, "nanda": [2, 8], "natur": [], "nearest": 4, "need": [3, 4, 5, 6, 8, 9, 10, 11, 12, 13], "neel": [2, 8], "neighbor": 4, "neo": 8, "neox": 8, "network": [8, 11, 12, 14], "neural": 8, "neuron": [2, 4, 12, 14], "neuron_idx": [2, 14], "new": [7, 8], "nn": 7, "node": [], "none": 8, "normal": 7, "now": 8, "nuanc": 4, "num_attention_head": 8, "num_hidden_lay": 8, "num_key_value_head": 8, "num_token": [1, 14], "number": [5, 9], "o": [0, 14], "object": 8, "observ": [2, 3], "obsess": 8, "obtain": 4, "obviou": [], "occur": 0, "offer": [3, 5, 8, 10, 11], "one": 8, "ones": 7, "onto": [3, 13, 14], "open": 8, "oper": [0, 7, 8], "optim": 12, "option": [], "order": [7, 8], "origin": [0, 13], "other": 1, "our": [], "out": 8, "output": [2, 5, 6, 10, 11], "overal": [1, 9], "overwhelm": 8, "own": 8, "page": 8, "pair": 3, "parallel": 8, "paramet": 8, "part": [0, 1, 4, 5, 8], "particular": [0, 4], "particularli": [2, 4, 7], "pass": [7, 8], "patch": [0, 14], "path": [0, 7, 14], "pattern": [0, 1, 3, 12, 14], "perceptron": 10, "perfecto": 8, "perform": [0, 1, 2, 7, 14], "permut": [7, 14], "permute_lay": [7, 14], "person": 8, "phi3": 8, "pinpoint": 1, "pip": 8, "pivot": 0, "placehold": 8, "plai": [0, 1, 8], "plan": [], "pleas": 8, "plot": 8, "plot_result": 8, "plot_typ": 8, "plotspec": 8, "plt": 8, "plu": 8, "plug": 8, "polysemant": [4, 12, 14], "polysemantic_scor": [4, 14], "polysemat": 4, "polysemi": [4, 12], "popular": 8, "posit": 3, "post": 8, "power": 2, "pr": 8, "practic": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "practition": [4, 5, 7, 9, 10, 11], "pre": 8, "pre_trained_models_hf": 7, "predict": [0, 2, 6, 7, 11, 14], "predominantli": 9, "preserv": 10, "pretrain": [], "pretrainedmodel": 8, "pretti": 8, "preval": [], "primarili": 9, "principl": [3, 4, 8], "print": 8, "probabl": [2, 14], "probe": [4, 8, 14], "prober": [6, 8, 14], "problem": [], "process": [1, 4, 5, 6, 9, 11, 12], "produc": 8, "product": 0, "profil": 8, "profile_model": 8, "progress": 8, "project": [3, 8, 13, 14], "project_activ": [13, 14], "project_token_embed": [3, 14], "propag": [5, 11], "propos": [], "provi": 8, "provid": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13], "prune": [12, 14], "prune_network": [12, 14], "pub": [], "purpos": 8, "python": 7, "q": [0, 3, 14], "queri": [0, 3], "quickli": 8, "qwen2": 8, "rang": [], "read": [3, 8, 14], "read_head": 8, "read_layer_idx": 8, "read_write_analysi": 8, "read_write_head": [9, 14], "readm": [], "readwritehead": 9, "real": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "realli": [1, 8, 14], "receiv": 1, "recent": 8, "reconstruct": [13, 14], "reconstruct_activ": [13, 14], "reduc": [8, 12], "redund": [1, 14], "ref": [], "refer": 8, "regardless": 8, "regist": [], "rel": 8, "relat": [3, 4, 14], "relationship": [0, 3, 13], "relev": 4, "remov": 12, "replac": [7, 14], "replace_lay": [7, 14], "repres": [3, 4], "represent": [4, 6, 13], "reprodc": 8, "request": [], "requir": [3, 8], "research": [4, 5, 7, 8, 9, 10, 11], "residu": [8, 14], "residual_decompos": [10, 14], "residual_decomposit": [11, 14], "residual_mov": [11, 14], "residual_tool": [11, 14], "residualdecompos": 10, "residualtool": 11, "resourc": 8, "respect": 8, "respons": 0, "retriev": [3, 7], "return": [1, 5, 7, 8, 9, 14], "reveal": [1, 2], "revers": 8, "rigor": 2, "role": [0, 1, 2, 6, 9, 11], "run": 8, "rust": [], "sae": 6, "same": [1, 4, 8], "save": 8, "save_dir": 8, "scale": [2, 14], "scenario": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "scene": 8, "score": [4, 14], "scrub": 2, "search": [], "second": 8, "section": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "see": [8, 11, 14], "self": [7, 8], "semant": 3, "sequenc": [1, 2], "server": [], "set": 4, "set_plotting_lib": 8, "sever": 8, "sexi": [], "shed": 0, "should": 8, "show": 8, "sidebar": [], "signal": 10, "signific": [1, 5, 8, 10], "significantli": [], "similar": 3, "sinc": [], "singl": 8, "small": 8, "snippet": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "so": 8, "softwar": [], "solid": 5, "some": 8, "someon": 8, "someth": 8, "sophist": 3, "sourc": [0, 8, 9, 14], "space": [3, 4, 13], "spars": 12, "sparsiti": [8, 14], "sparsity_analyz": [12, 14], "sparsity_threshold": [12, 14], "sparsityanalyz": 12, "spec": 8, "special": [0, 5], "specif": [1, 2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14], "specifi": [1, 2, 3, 4, 5, 7, 9, 10, 11, 12, 13, 14], "src": 8, "src_head": [0, 14], "src_idx": 8, "src_token": [9, 14], "stabl": 8, "stage": 6, "start": 8, "step1": 8, "step2": 8, "step3": 8, "store": 8, "stream": [10, 11, 14], "strongli": 4, "structur": [], "sub": 3, "subfield": 8, "subspac": [3, 14], "suit": [8, 11], "super": 8, "superpos": 13, "superposit": [8, 14], "superposition_disentangl": [13, 14], "superpositiondisentangl": 13, "support": 8, "surgeri": 14, "t": 8, "target": [2, 5, 6, 14], "target_id": [11, 14], "target_idx": [2, 5, 6, 14], "target_token": 5, "task": 3, "team": [], "techniqu": [3, 5], "temporari": 7, "temporarili": [1, 7], "test": [2, 8], "test_custom_funct": 8, "test_hypothesi": 8, "text": 3, "than": 8, "thei": 8, "them": 8, "theoret": [3, 4, 5, 9, 10, 11], "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "thing": 8, "think": 8, "third": 8, "those": [4, 5, 9, 10, 11], "thought": [0, 8], "thread": 0, "three": [0, 8], "threshold": [3, 9, 12, 14], "through": [2, 5, 11, 14], "throughout": [11, 14], "time": 8, "todo": 8, "toi": 13, "token": [1, 2, 3, 4, 5, 6, 9, 11, 14], "token_id": [3, 14], "tool": [2, 3, 4, 5, 6, 7, 9, 10, 12, 13, 14], "top": [1, 3, 8, 10, 13, 14], "top_attended_id": [1, 14], "top_k": [3, 10, 14], "torch": 7, "total": [5, 14], "toward": 2, "trace": [8, 9, 14], "trace_information_flow": [9, 14], "trace_token_prob": [2, 14], "track": [5, 8, 11, 14], "track_token_circul": [5, 14], "train": [], "transform": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "transit": 13, "translat": [], "tripartit": 0, "try": 8, "tune": 7, "two": [0, 1, 11, 13, 14], "type": [3, 12, 14], "under": [], "understand": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "updat": 8, "upper": 8, "us": [1, 2, 4, 7, 8, 12, 13], "usag": [], "use_tool": 8, "user": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "util": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13], "v": [0, 14], "valu": [0, 12], "valuabl": [3, 13], "variant": [], "varieti": 1, "variou": [3, 4, 6], "ve": 8, "vector": 3, "veri": [], "versatil": 0, "version": 8, "view": 6, "vision": 2, "visual": [1, 3, 14], "vocab_s": 8, "wa": [], "wai": [4, 8], "want": 8, "we": [0, 8], "weight": [0, 1, 8], "well": 8, "went": [], "what": [0, 8], "when": [], "where": [8, 11, 14], "whether": [], "which": [0, 4, 5, 8], "who": 8, "whole": 8, "why": 8, "wide": [], "within": [0, 1, 2, 3, 4, 7, 9, 10, 11, 12, 13], "word": 4, "work": [0, 7, 8], "workflow": [], "workload": 8, "world": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13], "wrapper": 8, "write": [8, 14], "write_head": 8, "write_layer_idx": 8, "write_read": 8, "writereadanalyz": [9, 14], "www": [], "you": [], "your": 8}, "titles": ["Attention Head Composition", "Attention Tools", "Causal Tracing Intervention", "Knowledge Graph Extractor", "Knowledge Prober", "Logit Attribution", "LogitLens", "Model Surgery", "Introduction", "Read Write Heads", "Residual Decomposer", "Residual Tools", "Sparsity Analyzer", "Superposition Disentangler", "Arrakis\u2019s documentation!"], "titleterms": {"": 14, "1": 8, "2": 8, "3": 8, "4": 8, "5": 8, "But": [], "analyz": 12, "api": [0, 1, 2, 3, 6, 7, 9, 10, 11, 12, 13], "ar": [], "arraki": [8, 14], "attent": [0, 1], "attentionheadcomposit": 14, "attentiontool": 14, "attribut": 5, "bench": 8, "causal": 2, "causaltracingintervent": 14, "cli": [], "composit": 0, "content": 14, "creat": 8, "decompos": [8, 10], "disentangl": 13, "doc": [], "document": 14, "doe": [], "exampl": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13], "experi": 8, "extend": 8, "extractor": 3, "from": [], "graph": 3, "head": [0, 9], "hookedautomodel": 8, "how": [], "indic": [], "instal": 8, "interpret": 8, "intervent": 2, "introduct": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "knowledg": [3, 4], "knowledgegraphextractor": 14, "knowledgeprob": 14, "list": 8, "logit": 5, "logitattribut": 14, "logitlen": [6, 14], "mani": [], "mean": [], "method": [4, 5], "model": 7, "modelsurgeri": 14, "packag": 8, "prober": 4, "provid": [], "read": 9, "readwritehead": 14, "refer": [0, 1, 2, 3, 6, 7, 9, 10, 11, 12, 13], "residu": [10, 11], "residualdecompos": 14, "residualtool": 14, "resourc": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13], "result": 8, "set": 8, "sparsiti": 12, "sparsityanalyz": 14, "step": 8, "superposit": 13, "superpositiondisentangl": 14, "surgeri": 7, "tabl": [], "tool": [1, 8, 11], "trace": 2, "up": 8, "us": [], "usag": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13], "visual": 8, "walkthrough": 8, "welcom": [], "what": [], "write": 9, "you": 8}})